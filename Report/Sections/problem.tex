%==============================================

Although there have been uncertainties in capturing the topography of the ocean near shore, mathematical methods can estimate bathymetry using the dispersion relationship between wavelength and the period. Stockdon et al. used video imagery, which compared true wave signal and remotely sensed video signal to create a linear representation between wave amplitudes and phases \citep{stockdon2000}.  Holman et al. used a 2-dimensional method with Kalman filtering to estimate the depth, $h$ \citep{holman2013}.

We invert for depth, \textit{h}, using wave length and wave number with a 1D model derived using the energy flux method to create a correlation between wave length and depth from the water surface as shown in Figure~\ref{flowchart}.

\begin{figure}[h]
		\centering
		\includegraphics[width=.40\linewidth]{img/Flow_Chart.jpg}
		\caption{Acoustic Wave and Current Profiler. Image source: http://www.nortek-as.com/en/products/wave-systems/awac}
		\label{AWAC}
\end{figure}

\subsection{Forward Problem}\label{forwardproblem}
The forward problem is described by 1D linear wave theory:
\begin{eqnarray}
\label{fp1}
\left \{
\begin{array}{lll}
\frac{d}{dx}\left(EC_g\right)=-\delta,\\
\\
\sigma^2=gk\tanh(kh),
\label{ode}
\end{array}
\right.
\end{eqnarray}
where $\delta$ is  wave breaking parameter and the speed at which the energy is transmitted, $C_g$, called linear theory group speed, is given as
\begin{equation}
\label{cg}
C_g=\frac{c}{2}\left(1+\frac{2kh}{\sinh(2kh)}\right),
\end{equation}
with $c=\frac{\sigma}{k}$ and from the linear theory, the wave energy, $E$ is given as
\begin{equation}
\label{e}
E=\frac{1}{8}\rho g H^2,
\end{equation}
$\rho$ is the density of water, $g$ is the gravitational acceleration, $\sigma$ is the angular frequency, $c$ is the local wave phase speed, $k$ is the wave number, $h$ is the water depth and $H$ is the wave height. Here, we assume $T$, the wave period, is constant.\\ 

\noindent Observe that equation \ref{fp1} is coupled using the fact that $\sigma=\frac{2\pi}{T}$. Hence, using equation \ref{cg} and \ref{e} in \ref{fp1}, we obtain
\begin{equation}
\label{fpdelta}
\frac{d}{dx}\left( \frac{\lambda}{k}\left(1+\frac{2kh}{\sinh(2kh)}\right)H^2 \right)=-\delta,
\end{equation}  
and 
\begin{equation}
\label{fk}
f(k) = gk\tanh(kh)-\sigma^2,
\end{equation}
where $k$ is the zero of function $f$ and $\lambda=\frac{\rho g \pi}{8T}$.\\

The wave breaking, $\delta$, proposed by (Janssen and Battjes, 2007) is given as
\begin{equation}
\delta = \frac{1}{4h}B\rho g f H_{rms}\left[(R^3+\frac{3}{2}R)e^{-R^2}+\frac{3}{4}\sqrt{\pi}(1-erf(R))\right],
\end{equation}
where $$R=\frac{H_b}{H_{rms}}, \quad H_b = 2\sqrt{2}H_{m0},\quad H_b=0.78h,\quad f=\frac{1}{T},\quad B=1.$$
\subsection{Numerical Solution of the Forward Model}
A finite difference scheme is applied to obtain a numerical solution with appropriate initial and boundary conditions. In the scheme of finite differences, the derivatives are replaced using their finite-difference approximations. The goal is to provide wave height using the finite difference method. In the process, MATLAB's fsolve function is applied to obtain the wave number. Furthermore, the Newton-Raphson method is used to verify the solution of wave number $k$ obtained by the fsolve function.
\subsubsection{Discretization of the Model}
A forward difference method is applied depending on the nature of the model given in equation (\ref{fpdelta}).\\
Let 
$$c^{*} = \frac{c_{g}\lambda}{k},\quad c_{g} = nc =\frac{2\pi n}{T},$$
with 
$$\lambda = \frac{1}{8}\rho g, \quad n = \frac{1}{2}\left(1+\frac{2hk}{sinh(2hk)}\right).$$
Let $\widetilde{H}=H^{2}$. Then the ordinary differential equation of the model given in (\ref{fpdelta}) becomes
\begin{equation}
\frac{d}{dx}\left( c^{*}\widetilde{H}\right)=-\delta
\end{equation}
Applying the finite difference method, the above expression becomes
$$
\frac{c_{i}^{*}\widetilde{H}_{i}-c_{i-1}^{*}\tilde{H}_{i-1}}{\triangle x}= \delta \quad \Rightarrow \quad
\widetilde{H}_{i}=\frac{c_{i-1}^{*}\widetilde{H}_{i-1}+\triangle x \delta}{c_{i}^{*}}
$$
Hence, at each index point in the discretization, $
H=\sqrt{\widetilde{H}}$.
\subsubsection*{MATLAB function fsolve}
As part of the process of obtaining wave height, $H$, MATLAB function fsolve is used as non-linear solver to find the zeros of the function given in (\ref{fk}) obtained from the dispersion relationship
$$
\sigma^{2}=gk tanh(kh).
$$ 
So, at each index point, wave number, $k$, is generated with initial guess $k_0$:
$$k_0=\frac{\sigma}{\sqrt{gh}}.$$
\subsubsection*{Newton-Raphson Method}
The Newton-Raphson method is a widely used method for finding roots. This method is used in the numerical experiment to verify the wave number extracted using MATLAB function fsolve. Therefore, approximate solution using Newton-Raphson method is obtained as
\begin{eqnarray}
k_{i+1}& =& k_{i}-\frac{gk_i\tanh(k_ih)-\sigma^2}{g\tanh(k_ih)-ghk_i sech^2(k_ih)},
\end{eqnarray}
using the same initial guess as for fsolve.
This provides the wave number, $k$, for each index.

\subsubsection{Implementation}
To apply the finite difference method we first discretize the space vector, ${x}$, depending on predefined mesh size, ${\Delta x}$. For test purposes, ${\Delta x}$ is considered to be ${10~m}$ which means we estimate wave height, $H$, every 10 meters. The finite difference scheme provides a sparse bidiagonal matrix. In this experiment, a wave breaking condition is applied as a maximum value on estimates of wave height at each index point. The wave breaking condition applied in this experiment is
$${H=0.78h}$$
%The reason for this condition is the model is focused on the shallow water. In shallow water the individual wave breaks when the wave height  ${(H)}$ and depth ${h}$ relationship is 
%$${H>0.8h}$$

The implementation of the algorithm is as follows
\begin{algorithm}
\caption{Algorithm to estimate wave height H}\label{euclid}
\begin{algorithmic}[1]
\Procedure{}{}
\BState \emph{\textit{\textbf{Initialization}}}:

\State $\textit{Initial depth:\,\,} h$
\State $\textit{Wave period:\,\,} T$
\State $\textit{Wave number estimated from fsolve:\,\,}k$
\State $\textit{Wave breaking:\,\,}\delta$

\BState \emph{\textbf{Step 1:}}
\State $\bullet \quad\textit{constant}\quad \lambda=\frac{ \rho g \pi}{8T}$

\BState \emph{\textbf{Step 2:}}
\State $\bullet \quad\textit{Find\,\,} c^{*} \textit{\,\,depending on \,\,}k:\quad c^{*}=\frac{(1+(2kh)}{sinh(2kh)}\lambda \,\, k$

\BState \emph{\textbf{Step 3:Compute wave height H}}
\State $\bullet \quad\textit{Compute:\,\,}\widetilde{H}:\quad \widetilde{H}_{i}=\frac{c_{i-1}^{*}\widetilde{H}_{i-1}+\triangle x \delta}{c_{i}^{*}}$
\State $\bullet \quad\textit{Compute wave break condition\,\,}Hmax:0.78 h$

\State $\bullet \quad\textit{Take minimum between\,}\widetilde{H} \textit{\, and \,\,} Hmax \textit{\,\,at each index\,\,}i\quad $

\EndProcedure
\end{algorithmic}
\end{algorithm} 


\subsubsection{Numerical Results}
We present some of the numerical results in the following Figures.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[h]
\begin{minipage}[b]{0.47\linewidth}
\centering
\includegraphics[width=\textwidth]{forward_plot/p1_1.eps}
%\caption{Case I: Water Depth(h), Wave Height(H) and Wave Number vary with x direction}
\label{FigHhk_1}
\end{minipage}
\hspace{0.2cm}
\begin{minipage}[b]{0.47\linewidth}
\centering
\includegraphics[width=\textwidth]{forward_plot/p2_1.eps}
%\caption{Case II: $N=500$}
\label{FigHhk_2}
\end{minipage}
\caption{Water Depth(h), Wave Height(H) and Wave Number vary with x direction (Two sets of boundary conditions are applied for following figures)}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[h]
\begin{minipage}[b]{0.47\linewidth}
\centering
\includegraphics[width=\textwidth]{forward_plot/p1_2.eps}
%\caption{Example \eqref{ex1} Case I: $N=100$}
\label{Fighk_1}
\end{minipage}
\hspace{0.2cm}
\begin{minipage}[b]{0.47\linewidth}
\centering
\includegraphics[width=\textwidth]{forward_plot/p2_2.eps}
%\caption{Example \eqref{ex1} Case I: $N=500$}
\label{Fighk_2}
\end{minipage}
\caption{Relative Depth varies with x direction}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[h]
\begin{minipage}[b]{0.47\linewidth}
\centering
\includegraphics[width=\textwidth]{forward_plot/p1_3.eps}
%\caption{Example \eqref{ex1} Case I: $N=100$}
\label{Figenergy_1}
\end{minipage}
\hspace{0.2cm}
\begin{minipage}[b]{0.47\linewidth}
\centering
\includegraphics[width=\textwidth]{forward_plot/p2_3.eps}
%\caption{Example \eqref{ex1} Case I: $N=500$}
\label{Figenergy_2}
\end{minipage}
\caption{Wave Energy varies with x direction}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[h]
\begin{minipage}[b]{0.47\linewidth}
\centering
\includegraphics[width=\textwidth]{forward_plot/p1_4.eps}
%\caption{Example \eqref{ex1} Case I: $N=100$}
\label{Figc_1}
\end{minipage}
\hspace{0.2cm}
\begin{minipage}[b]{0.47\linewidth}
\centering
\includegraphics[width=\textwidth]{forward_plot/p2_4.eps}
%\caption{Example \eqref{ex1} Case I: $N=500$}
\label{Figc_2}
\end{minipage}
\caption{Wave Phase Speed (c) varies with x direction}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[h]
\begin{minipage}[b]{0.47\linewidth}
\centering
\includegraphics[width=\textwidth]{forward_plot/p1_5.eps}
%\caption{Example \eqref{ex1} Case I: $N=100$}
\label{FigH_1}
\end{minipage}
\hspace{0.2cm}
\begin{minipage}[b]{0.47\linewidth}
\centering
\includegraphics[width=\textwidth]{forward_plot/p2_5.eps}
%\caption{Example \eqref{ex1} Case I: $N=500$}
\label{FigH_2}
\end{minipage}
\caption{Wave Height(H) varies with Water Depth(h)}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[h]
\begin{minipage}[b]{0.47\linewidth}
\centering
\includegraphics[width=\textwidth]{forward_plot/p1_7.eps}
%\caption{Example \eqref{ex1} Case I: $N=100$}
\label{FigE_1}
\end{minipage}
\hspace{0.4cm}
\begin{minipage}[b]{0.47\linewidth}
\centering
\includegraphics[width=\textwidth]{forward_plot/p2_7.eps}
%\caption{Example \eqref{ex1} Case I: $N=500$}
\label{FigE_2}
\end{minipage}
\caption{Wave Energy varies with Wave Height(H)}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%